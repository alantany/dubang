# 都邦健康小程序

一个基于微信小程序的健康服务咨询应用。

## 功能特点

- 语音输入：支持按住说话功能，方便用户进行语音交互
- 文字输入：提供文本输入框，支持文字方式咨询
- 智能问答：集成Coze API，提供智能对话服务
- 视频展示：根据用户咨询内容展示相关的健康产品和服务视频

## 技术实现

### 语音功能
- 使用微信小程序原生的录音API（RecorderManager）
- 支持录音、播放等基础功能
- 提供录音状态反馈，优化用户体验

### 智能对话
- 集成Coze API实现智能对话
- API调用示例：
```javascript
wx.request({
  url: 'https://api.coze.cn/open_api/v2/chat',
  method: 'POST',
  header: {
    'Authorization': 'Bearer YOUR_API_KEY',
    'Content-Type': 'application/json'
  },
  data: {
    conversation_id: 'CONVERSATION_ID',
    bot_id: 'BOT_ID',
    user: 'USER_ID',
    query: '用户输入内容',
    stream: false
  }
})
```

### 界面组件
- 使用自定义组件实现界面模块化
- display-area：展示视频和描述信息
  - 采用卡片式布局设计
  - 使用渐变背景和阴影效果
  - 添加淡入动画提升体验
  - 针对不同类型文本使用差异化样式
- 语音按钮：实现长按说话功能
  - 优化按钮尺寸和触感
  - 添加按压反馈动画
  - 使用渐变色和立体阴影

## 问题解决记录

### 资源路径问题
- 问题：图片和视频等静态资源无法正常显示
- 原因：小程序中的路径引用有特殊规则
- 解决方案：
  1. 使用绝对路径：以 "/" 开头，例如 "/videos/test.mp4"
  2. 确保资源文件放在正确的目录下（miniprogram目录内）
  3. 不要在路径中包含 "miniprogram" 目录名
  4. 视频文件需要符合小程序要求（格式、大小等）

### 按钮点击问题
- 问题：按钮点击事件无响应
- 解决：重构事件绑定方式，简化组件结构

### API调用问题
- 问题：uploadFile接口域名校验错误
- 解决：使用Coze官方API进行对话功能实现

## 开发笔记

1. 组件化开发
   - 将界面拆分为可复用的组件
   - 实现组件间的数据传递和事件通信

2. 状态管理
   - 使用Page的data属性管理状态
   - 实现录音、对话等状态的实时更新

3. 错误处理
   - 添加全局的错误处理机制
   - 为用户提供友好的错误提示

4. UI设计优化
   - 采用现代化的卡片式布局
   - 使用渐变色和阴影提升视觉层次
   - 添加适当的动画效果增强交互体验
   - 优化按钮的触感反馈

## 后续优化计划

1. 优化语音识别准确率
2. 增加更多健康服务类型
3. 优化界面交互体验
4. 添加用户个性化推荐功能

## 使用说明

1. 克隆项目到本地
2. 在微信开发者工具中导入项目
3. 配置Coze API密钥
4. 编译运行即可使用

## 注意事项

1. 需要在微信开发者工具中开启相关权限
2. 注意保护API密钥等敏感信息
3. 遵循微信小程序的发布规范
4. 视频文件要求：
   - 格式：MP4
   - 编码：H.264
   - 大小：建议每个视频不超过10MB
   - 时长：建议不超过1分钟